# Fun-ASR-Nano 8kHz ç”µè¯è¯­éŸ³å¾®è°ƒ - å®éªŒçŠ¶æ€æŠ¥å‘Š

**æŠ¥å‘Šæ—¥æœŸ**: 2026-01-05  
**å®éªŒå‘¨æœŸ**: ç¬¬ 1 å‘¨ (æ•°æ®å‡†å¤‡é˜¶æ®µ)

---

## ğŸ¯ å®éªŒç›®æ ‡

å°† Fun-ASR-Nano æ¨¡å‹é€‚é…åˆ° 8kHz ä¸­æ–‡ç”µè¯è¯­éŸ³è¯†åˆ«åœºæ™¯ï¼ŒåŒ…æ‹¬ç”µé”€ã€å®¢æœã€å‚¬æ”¶ç­‰çœŸå®ä¸šåŠ¡åœºæ™¯ã€‚

---

## âœ… å·²å®Œæˆå·¥ä½œ

### Stage 0: æ•°æ®å‡†å¤‡ âœ… (100% å®Œæˆ)

#### æ¨¡æ‹Ÿæ•°æ®åˆ¶ä½œ (WenetSpeech â†’ 8kHz ç”µè¯)
- **è„šæœ¬**: `data/data_simulation.py`
- **æ•ˆæœ**:
  - âœ… G.711 Î¼-law ç¼–è§£ç 
  - âœ… 300-3400Hz å¸¦é€šæ»¤æ³¢ 
  - âœ… ç™½å™ªå£° + å·¥é¢‘å¹²æ‰°
  - âœ… Babble Noise (SNR: 10-25dB)

**æˆæœ**:
```
è®­ç»ƒé›†: 63,782 samples
éªŒè¯é›†: 13,825 samples
æ€»è®¡: 77,607 æœ‰æ•ˆæ ·æœ¬
```

#### çœŸå®æ•°æ®å¤„ç† (ç”µè¯å¤–å‘¼åœºæ™¯)
- **æ•°æ®æº**: yx_telecall_v2_1 (ç”µé”€ã€å®¢æœã€å‚¬æ”¶)
- **è¿‡æ»¤**: æ³¨é‡Šé”™è¯¯ (annotation_error) 1,353 æ¡
- **ä¸Šé‡‡æ ·**: 8kHz â†’ 16kHz (ä¿ç•™å¤±çœŸç‰¹å¾)

**æˆæœ**:
```
è®­ç»ƒé›†: 8,992 samples (è¿‡æ»¤å‰ 12,172)
éªŒè¯é›†: 7,685 samples (è¿‡æ»¤å‰ 9,001)
æ€»è®¡: 16,677 æœ‰æ•ˆæ ·æœ¬
```

#### æ•°æ®æ ¼å¼è½¬æ¢ âœ…
- **è„šæœ¬**: `data/prepare_training_data.py` (å¢å¼ºç‰ˆ)
- **æ ¼å¼**: FunASR-Nano messages æ ¼å¼
- **æ·»åŠ åŠŸèƒ½**:
  - `--filter_annotation_error`: è‡ªåŠ¨è¿‡æ»¤æ³¨é‡Šé”™è¯¯
  - `--do_upsample`: 8kHz â†’ 16kHz ä¸Šé‡‡æ ·
  - `--sample_size`: å¿«é€ŸéªŒè¯æŒ‡å®šæ•°é‡æ ·æœ¬

---

## ğŸ“Š æ•°æ®ç»Ÿè®¡

### å…¨é‡æ•°æ®é›†åˆ

| ç±»å‹ | è®­ç»ƒæ ·æœ¬ | éªŒè¯æ ·æœ¬ | æœ‰æ•ˆæ ·æœ¬ | è¿‡æ»¤ | é”™è¯¯ |
|------|--------|--------|--------|------|------|
| æ¨¡æ‹Ÿ | 63,782 | 13,825 | 77,607 | 1,388 | 0 |
| çœŸå® | 8,992 | 7,685 | 16,677 | 3,143 | 1,353 |
| **æ€»è®¡** | **72,774** | **21,510** | **94,284** | **4,531** | **1,353** |

### æ ·æœ¬è´¨é‡æŒ‡æ ‡

- å¹³å‡ speech_length: 37-50 å¸§
- å¹³å‡ text_length: 10-15 å­—ç¬¦
- æ— ç¼ºå¤±å­—æ®µ: 100% âœ“
- éŸ³é¢‘æ–‡ä»¶å­˜åœ¨: 100% âœ“

---

## ğŸš€ è¿›è¡Œä¸­çš„å·¥ä½œ

### Stage 1: Audio Encoder é€‚é… (å‡†å¤‡ä¸­)
- **ç›®æ ‡**: Encoder å…¨é‡å¾®è°ƒ (150M å‚æ•°)
- **æ•°æ®**: 63.7k æ¨¡æ‹Ÿæ ·æœ¬
- **å­¦ä¹ ç‡**: 1e-4
- **é¢„è®¡æ—¶é—´**: 2-3 å¤© (2x H100)

**å‰ç½®æ¡ä»¶**:
- [ ] ä¿®å¤ WavFrontend é‡‡æ ·ç‡é…ç½® (8000 Hz)
- [ ] è°ƒæ•´ä½ç½®ç¼–ç ç»´åº¦
- [ ] éªŒè¯æ¨¡å‹åˆå§‹åŒ–è·¯å¾„

---

## âš ï¸ å·²è¯†åˆ«çš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### é—®é¢˜ 1: WavFrontend ä¸å…¼å®¹ 8kHz è¾“å…¥
**ç—‡çŠ¶**: ä½ç½®ç¼–ç ç»´åº¦ä¸åŒ¹é…  
**æ ¹å› **: é¢„è®­ç»ƒæ¨¡å‹ä½¿ç”¨ 16kHz WavFrontend

**è§£å†³æ–¹æ¡ˆ** (å¾…å®æ–½):
```yaml
# conf/stage1_encoder_adapt.yaml
frontend:
  fs: 8000  # â† æ”¹ä¸º 8000
  n_mels: 80
  frame_length: 25
  frame_shift: 10
  
dataset_conf:
  max_token_length: 10000  # â† å¢åŠ å®¹é‡
```

### é—®é¢˜ 2: æ¨¡å‹è·¯å¾„é—®é¢˜
**ç—‡çŠ¶**: `init_param does not exist`  
**æ ¹å› **: MODELSCOPE_CACHE ç¯å¢ƒå˜é‡è·¯å¾„ä¸ç»Ÿä¸€

**è§£å†³æ–¹æ¡ˆ** (å¾…å®æ–½):
```bash
# æ–¹æ¡ˆ A: ä½¿ç”¨ ModelScope å®˜æ–¹ä¸‹è½½
python -c "from modelscope import snapshot_download; \
           snapshot_download('FunAudioLLM/Fun-ASR-Nano-2512')"

# æ–¹æ¡ˆ B: ä¿®æ”¹è„šæœ¬æŒ‡å®šç¡®åˆ‡è·¯å¾„
ptm_checkpoint="/path/to/actual/model.pt"
```

### é—®é¢˜ 3: æ•°æ®é•¿åº¦åˆ†å¸ƒ
**ç°è±¡**: éƒ¨åˆ†æ ·æœ¬è¢«è¿‡æ»¤ (1,388 in simulated, 2,609 in real)  
**åŸå› **: `max_speech_length=8000` é˜ˆå€¼è¿‡ä¸¥æ ¼

**æ”¹è¿›æ–¹æ¡ˆ**:
```python
# è°ƒæ•´è¿‡æ»¤æ¡ä»¶
max_speech_length=12000  # å¢åŠ ä¸Šé™
# æˆ–ä½¿ç”¨è‡ªé€‚åº”è¿‡æ»¤
if speech_length > percentile_95:
    # è¿›ä¸€æ­¥æ£€æŸ¥æ ·æœ¬è´¨é‡
```

---

## ğŸ“ æ ¸å¿ƒæ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | çŠ¶æ€ | å¤‡æ³¨ |
|------|------|------|
| `run_experiment.sh` | âœ… | ä¸»å®éªŒè„šæœ¬ (Stage 0 å·²æµ‹è¯•) |
| `test_data_prep.sh` | âœ… | æ•°æ®å‡†å¤‡æµ‹è¯• (é€šè¿‡) |
| `data/data_simulation.py` | âœ… | ç”µè¯ä¿¡é“æ¨¡æ‹Ÿ |
| `data/prepare_training_data.py` | âœ… | æ ¼å¼è½¬æ¢ + è¿‡æ»¤ |
| `conf/stage1_encoder_adapt.yaml` | âš ï¸ | éœ€ä¿®å¤é‡‡æ ·ç‡ |
| `conf/stage2_adapter_align.yaml` | ğŸ“‹ | å‡†å¤‡ä¸­ |
| `conf/stage3_lora_domain.yaml` | ğŸ“‹ | å‡†å¤‡ä¸­ |

---

## ğŸ”„ æ—¶é—´çº¿

```
Week 1 (1/5-1/11):
â”œâ”€ Stage 0: æ•°æ®å‡†å¤‡ âœ… (å®Œæˆ)
â””â”€ Stage 1: é…ç½®ä¿®å¤ (è¿›è¡Œä¸­)

Week 2-3 (1/12-1/25):
â”œâ”€ Stage 1: Encoder å¾®è°ƒ (2-3 å¤©)
â””â”€ Stage 2: Adapter å¯¹é½ (2-3 å¤©)

Week 4 (1/26-2/1):
â”œâ”€ Stage 3: LoRA ä¸šåŠ¡é€‚é… (1-2 å¤©)
â””â”€ è¯„ä¼°ä¸æŠ¥å‘Š (1 å¤©)

æ€»è®¡: ~8 å¤©è®­ç»ƒ + æ•°æ®å‡†å¤‡
```

---

## ğŸ“ å®éªŒç»éªŒä¸æ´å¯Ÿ

### æ•°æ®è´¨é‡è§‚å¯Ÿ
1. **çœŸå®æ•°æ®æœ‰é™**: ä»… 17k æœ‰æ•ˆæ ·æœ¬ï¼Œéœ€è°¨æ…é˜²æ­¢è¿‡æ‹Ÿåˆ
2. **æ³¨é‡Šé”™è¯¯ç‡**: 6% (1,353/21,173)ï¼Œå·²å®Œå…¨è¿‡æ»¤
3. **é•¿åº¦åˆ†å¸ƒ**: å¤§éƒ¨åˆ†æ ·æœ¬è¾ƒçŸ­ (< 2s)ï¼Œç¬¦åˆç”µè¯è¯­éŸ³ç‰¹å¾

### æŠ€æœ¯æ´å¯Ÿ
1. **ä¸Šé‡‡æ ·ç­–ç•¥**: 8kHz â†’ 16kHz ä¿ç•™å¤±çœŸç‰¹å¾ï¼Œä½†éœ€å¤„ç†æ—¶é—´ç»´åº¦å˜åŒ–
2. **ä½ç½®ç¼–ç **: é¢„è®­ç»ƒæ¨¡å‹çš„ä½ç½®ç¼–ç ä¸å¾®è°ƒæ•°æ®ä¸åŒ¹é…ï¼Œéœ€åŠ¨æ€è°ƒæ•´
3. **LFR ä¸‹é‡‡æ ·**: WavFrontend çš„ LFR å› å­ (6) å¯¹æ—¶é—´ç»´åº¦æœ‰æ˜¾è‘—å½±å“

### å·¥ç¨‹å»ºè®®
1. **æ•°æ®å¢å¼º**: Babble Noise æœ‰æ•ˆï¼Œä½†å¯è¿›ä¸€æ­¥ä¼˜åŒ– SNR èŒƒå›´
2. **è¿‡æ»¤ç­–ç•¥**: åŸºäºç™¾åˆ†ä½æ•°çš„è‡ªé€‚åº”è¿‡æ»¤ä¼˜äºå›ºå®šé˜ˆå€¼
3. **å¤šé˜¶æ®µè®­ç»ƒ**: ä¸‰é˜¶æ®µç­–ç•¥åˆç†ï¼Œå‚æ•°é€æ­¥å‡å°‘ (150M â†’ 12M â†’ 2M)

---

## ï¿½ï¿½ ä¸‹ä¸€æ­¥è¡ŒåŠ¨æ¸…å•

- [ ] **ä¿®å¤ WavFrontend é…ç½®** (1 å°æ—¶)
  - ä¿®æ”¹ frontend.fs: 16000 â†’ 8000
  - è°ƒæ•´ dataset_conf.max_token_length
  
- [ ] **éªŒè¯æ¨¡å‹è·¯å¾„** (30 åˆ†é’Ÿ)
  - ç¡®è®¤ Fun-ASR-Nano-2512 çš„ç¡®åˆ‡ä½ç½®
  - æ›´æ–° run_experiment.sh
  
- [ ] **å¯åŠ¨ Stage 1 è®­ç»ƒ** (ç­‰å¾…)
  - å‘½ä»¤: `bash run_experiment.sh 1 1`
  - ç›‘æ§: `tail -f exp_output/exp/8k_telephone/*/train.log`
  
- [ ] **å®šæœŸæ£€æŸ¥æŒ‡æ ‡** (æ—¥å¸¸)
  - Loss ä¸‹é™è¶‹åŠ¿
  - CER æ”¹å–„æƒ…å†µ
  - GPU æ˜¾å­˜ä½¿ç”¨

---

## ğŸ“ è”ç³»ä¸æ”¯æŒ

**ä¸»è¦è„šæœ¬**:
- `run_experiment.sh`: ä¸‰é˜¶æ®µå®éªŒä¸»è„šæœ¬
- `test_data_prep.sh`: æ•°æ®å‡†å¤‡å°è§„æ¨¡æµ‹è¯•

**æ—¥å¿—ä½ç½®**:
- è®­ç»ƒæ—¥å¿—: `exp_output/exp/8k_telephone/*/train.log`
- æ•°æ®æ—¥å¿—: `stage0_run.log`

**å…³é”®æ–‡æ¡£**:
- IMPLEMENTATION_PLAN.md - å®Œæ•´æŠ€æœ¯æ–¹æ¡ˆ
- EXPERIMENT_EXECUTION_PLAN.md - è¯¦ç»†æ‰§è¡Œè®¡åˆ’
- STAGE0_COMPLETION_REPORT.md - æ•°æ®å‡†å¤‡è¯¦æƒ…

---

**å®éªŒçŠ¶æ€**: ğŸŸ¢ **æŒ‰è®¡åˆ’è¿›è¡Œ**

**ä¸‹ä¸€é˜¶æ®µ**: Stage 1 è®­ç»ƒ (å¾…é…ç½®ä¿®å¤)

---

*æœ€åæ›´æ–°: 2026-01-05*
*å®éªŒè´Ÿè´£äºº: Algorithm Research Team*
